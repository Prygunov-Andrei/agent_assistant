# Ğ ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾ LLM Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

## ĞĞ±Ğ·Ğ¾Ñ€

Ğ”Ğ°Ğ½Ğ½Ğ¾Ğµ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Large Language Model (LLM) Ğ² ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Agent Assistant Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ².

## ğŸ¯ Ğ¦ĞµĞ»Ğ¸ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

1. **ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²** - LLM Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ°Ğ³Ğ°ĞµÑ‚ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ¾Ğ²
2. **ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ°Ñ€Ñ‚Ğ¸ÑÑ‚Ğ¾Ğ²** - LLM Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ°Ñ€Ñ‚Ğ¸ÑÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ñ€Ğ¾Ğ»ĞµĞ¹ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
3. **ĞŸÑ€ĞµĞ´Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼** - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ĞµĞ¹ Ñ„Ğ¾Ñ€Ğ¼Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
4. **ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸** - Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ñ‚Ğ¾Ğ½ĞºĞ¾Ğ¹ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ LLM

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚     Backend      â”‚    â”‚      LLM        â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ LLM Status  â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ LLM Service  â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚   GPT-4o    â”‚ â”‚
â”‚ â”‚ Indicator   â”‚ â”‚    â”‚ â”‚              â”‚ â”‚    â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                 â”‚
â”‚ â”‚ Analysis    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Emulator     â”‚ â”‚    â”‚                 â”‚
â”‚ â”‚ Modal       â”‚ â”‚    â”‚ â”‚ Service      â”‚ â”‚    â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                 â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚                 â”‚
â”‚ â”‚ Project     â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Validation   â”‚ â”‚    â”‚                 â”‚
â”‚ â”‚ Form        â”‚ â”‚    â”‚ â”‚ Service      â”‚ â”‚    â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

1. **Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·** - ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ"
2. **ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…** - Ğ¡Ğ±Ğ¾Ñ€ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ°Ñ€Ñ‚Ğ¸ÑÑ‚Ğ¾Ğ²
3. **ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ² LLM** - Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚Ğ° Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ² GPT-4o
4. **Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°** - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ JSON Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
5. **ĞŸÑ€ĞµĞ´Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ñ€Ğ¼Ñ‹** - ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Ñ„Ğ¾Ñ€Ğ¼Ñƒ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
6. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ¾Ğ¼** - ĞĞ³ĞµĞ½Ñ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ¸ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
7. **Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°** - ĞŸÑ€Ğ¾ĞµĞºÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ² Ğ±Ğ°Ğ·Ñƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

## âš™ï¸ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### Ğ¤Ğ°Ğ¹Ğ» llm_config.yaml

```yaml
llm:
  # ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
  model: "gpt-4o"
  temperature: 0.7
  max_tokens: 2000
  timeout: 30
  
  # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº
  max_retries: 3
  retry_delay: 1.0
  
  # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
  strict_validation: true
  fallback_to_emulator: true

# ĞŸÑ€Ğ¾Ğ¼Ğ¿Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
prompts:
  analysis_prompt: |
    ĞŸÑ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞ¹ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° ĞºĞ°ÑÑ‚Ğ¸Ğ½Ğ³ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°.
    
    Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ: {request_text}
    
    Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ°Ñ€Ñ‚Ğ¸ÑÑ‚Ñ‹: {artists_data}
    
    Ğ’ĞµÑ€Ğ½Ğ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ JSON:
    {{
      "project_title": "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
      "project_type": "Ğ¢Ğ¸Ğ¿ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
      "genre": "Ğ–Ğ°Ğ½Ñ€",
      "description": "ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
      "premiere_date": "YYYY-MM-DD",
      "roles": [
        {{
          "role_type": "Ğ¢Ğ¸Ğ¿ Ñ€Ğ¾Ğ»Ğ¸",
          "character_name": "Ğ˜Ğ¼Ñ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ°",
          "description": "ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ñ€Ğ¾Ğ»Ğ¸",
          "age_range": "Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚Ğ½Ğ¾Ğ¹ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½",
          "gender": "ĞŸĞ¾Ğ»",
          "suggested_artists": [1, 2, 3],
          "skills_required": {{
            "acting_skills": ["Ğ½Ğ°Ğ²Ñ‹Ğº1", "Ğ½Ğ°Ğ²Ñ‹Ğº2"],
            "physical_skills": ["Ğ½Ğ°Ğ²Ñ‹Ğº1"],
            "languages": ["ÑĞ·Ñ‹Ğº1"],
            "special_requirements": ["Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ1"]
          }}
        }}
      ]
    }}

# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ
export:
  records_per_file: 50
  output_directory: "training_data"
  include_metadata: true
```

### Ğ¤Ğ°Ğ¹Ğ» search_config.yaml

```yaml
# ĞŸĞ¾Ñ€Ğ¾Ğ³Ğ¸ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹
thresholds:
  person:
    name: 0.8
    email: 0.9
    phone: 0.9
    telegram: 0.8
  
  company:
    name: 0.8
    contact_person: 0.7
  
  project:
    title: 0.8
    description: 0.6

# Ğ›Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
limits:
  max_results: 10
  min_confidence: 0.5
```

## ğŸ”§ Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### Backend ÑĞµÑ€Ğ²Ğ¸ÑÑ‹

#### LLMService
```python
class LLMService:
    def __init__(self):
        self.config = self._load_config()
        self.client = OpenAI(api_key=settings.OPENAI_API_KEY)
    
    def analyze_request(self, request_data, artists_data):
        """ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ñ‡ĞµÑ€ĞµĞ· LLM"""
        prompt = self._build_prompt(request_data, artists_data)
        
        try:
            response = self.client.chat.completions.create(
                model=self.config['llm']['model'],
                messages=[{"role": "user", "content": prompt}],
                temperature=self.config['llm']['temperature'],
                max_tokens=self.config['llm']['max_tokens']
            )
            
            result = self._parse_response(response.choices[0].message.content)
            return self._validate_result(result)
            
        except Exception as e:
            if self.config['llm']['fallback_to_emulator']:
                return self._fallback_to_emulator(request_data, artists_data)
            raise e
```

#### LLMEmulatorService
```python
class LLMEmulatorService:
    """Ğ­Ğ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€ LLM Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ"""
    
    def analyze_request(self, request_data, artists_data):
        """Ğ­Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°"""
        # Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° ÑĞ¼ÑƒĞ»ÑÑ†Ğ¸Ğ¸ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… ÑĞ»Ğ¾Ğ² Ğ² Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞµ
        if "Ğ´Ñ€Ğ°Ğ¼Ğ°" in request_data['text'].lower():
            return self._generate_drama_project(request_data, artists_data)
        elif "ĞºĞ¾Ğ¼ĞµĞ´Ğ¸Ñ" in request_data['text'].lower():
            return self._generate_comedy_project(request_data, artists_data)
        else:
            return self._generate_default_project(request_data, artists_data)
```

#### ValidationService
```python
class ValidationService:
    """Ğ¡ĞµÑ€Ğ²Ğ¸Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² LLM"""
    
    def validate_analysis_result(self, result):
        """Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ JSON Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°"""
        required_fields = ['project_title', 'project_type', 'roles']
        
        for field in required_fields:
            if field not in result:
                raise ValidationError(f"ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ: {field}")
        
        # Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ€Ğ¾Ğ»ĞµĞ¹
        for role in result.get('roles', []):
            self._validate_role(role)
        
        return True
```

### Frontend ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### LLMStatusIndicator
```typescript
interface LLMStatusIndicatorProps {
  status: AnalysisStatus;
  isLoading?: boolean;
}

const LLMStatusIndicator: React.FC<LLMStatusIndicatorProps> = ({ status, isLoading }) => {
  const getStatusColor = (status: AnalysisStatus) => {
    switch (status) {
      case 'new': return 'gray';
      case 'analyzing': return 'blue';
      case 'analyzed': return 'green';
      case 'error': return 'red';
      default: return 'gray';
    }
  };

  return (
    <div className={`status-indicator ${getStatusColor(status)}`}>
      {isLoading && <Spinner />}
      <span>{getStatusText(status)}</span>
    </div>
  );
};
```

#### RequestAnalysisModal
```typescript
interface RequestAnalysisModalProps {
  request: Request;
  isOpen: boolean;
  onClose: () => void;
  onAnalysisComplete: (result: LLMAnalysisResult) => void;
}

const RequestAnalysisModal: React.FC<RequestAnalysisModalProps> = ({
  request,
  isOpen,
  onClose,
  onAnalysisComplete
}) => {
  const [isAnalyzing, setIsAnalyzing] = useState(false);
  const [analysisResult, setAnalysisResult] = useState<LLMAnalysisResult | null>(null);

  const handleAnalyze = async () => {
    setIsAnalyzing(true);
    try {
      const result = await llmService.analyzeRequest(request.id);
      setAnalysisResult(result);
      onAnalysisComplete(result);
    } catch (error) {
      console.error('ĞÑˆĞ¸Ğ±ĞºĞ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:', error);
    } finally {
      setIsAnalyzing(false);
    }
  };

  return (
    <Modal isOpen={isOpen} onClose={onClose}>
      <div className="analysis-modal">
        <h2>ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°</h2>
        <div className="request-text">{request.text}</div>
        
        {isAnalyzing ? (
          <div className="analyzing">
            <Spinner />
            <p>ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ...</p>
          </div>
        ) : (
          <div className="analysis-result">
            {analysisResult && (
              <AnalysisResultDisplay result={analysisResult} />
            )}
          </div>
        )}
        
        <div className="modal-actions">
          <button onClick={handleAnalyze} disabled={isAnalyzing}>
            ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
          </button>
          <button onClick={onClose}>Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ</button>
        </div>
      </div>
    </Modal>
  );
};
```

## ğŸ“Š API Endpoints

### ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

#### POST /api/requests/{id}/analyze/
```json
{
  "request_id": 123,
  "use_emulator": false
}
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "success": true,
  "result": {
    "project_title": "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
    "project_type": "Ğ¢Ğ¸Ğ¿ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
    "genre": "Ğ–Ğ°Ğ½Ñ€",
    "description": "ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°",
    "premiere_date": "2024-12-31",
    "roles": [
      {
        "role_type": "ĞĞºÑ‚ĞµÑ€",
        "character_name": "Ğ˜Ğ²Ğ°Ğ½",
        "description": "Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ğ³ĞµÑ€Ğ¾Ğ¹",
        "age_range": "25-35",
        "gender": "male",
        "suggested_artists": [1, 2, 3],
        "skills_required": {
          "acting_skills": ["Ğ´Ñ€Ğ°Ğ¼Ğ°", "ĞºĞ¾Ğ¼ĞµĞ´Ğ¸Ñ"],
          "physical_skills": ["Ñ‚Ğ°Ğ½Ñ†Ñ‹"],
          "languages": ["Ñ€ÑƒÑÑĞºĞ¸Ğ¹"],
          "special_requirements": []
        }
      }
    ]
  }
}
```

#### GET /api/requests/{id}/analysis-status/
**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "status": "analyzed",
  "analyzed_at": "2024-01-15T10:30:00Z",
  "project_id": 456
}
```

### Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ñ

#### POST /api/admin/export-training-dataset/
```json
{
  "records_per_file": 50,
  "include_metadata": true
}
```

**ĞÑ‚Ğ²ĞµÑ‚:**
```json
{
  "success": true,
  "files_created": 3,
  "total_records": 150,
  "files": [
    "training_data_001.jsonl",
    "training_data_002.jsonl",
    "training_data_003.jsonl"
  ]
}
```

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Unit Ñ‚ĞµÑÑ‚Ñ‹

```python
class TestLLMService:
    def test_analyze_request_success(self):
        service = LLMService()
        request_data = {"text": "ĞÑƒĞ¶ĞµĞ½ Ğ°ĞºÑ‚ĞµÑ€ Ğ´Ğ»Ñ Ğ´Ñ€Ğ°Ğ¼Ñ‹"}
        artists_data = [{"id": 1, "name": "Ğ˜Ğ²Ğ°Ğ½ Ğ˜Ğ²Ğ°Ğ½Ğ¾Ğ²"}]
        
        result = service.analyze_request(request_data, artists_data)
        
        assert result['project_title'] is not None
        assert 'roles' in result
        assert len(result['roles']) > 0

    def test_analyze_request_validation_error(self):
        service = LLMService()
        request_data = {"text": "Invalid request"}
        
        with pytest.raises(ValidationError):
            service.analyze_request(request_data, [])
```

### Integration Ñ‚ĞµÑÑ‚Ñ‹

```python
class TestLLMIntegration:
    def test_full_analysis_workflow(self):
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°
        request = RequestFactory(text="ĞÑƒĞ¶ĞµĞ½ Ğ°ĞºÑ‚ĞµÑ€ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼ĞµĞ´Ğ¸Ğ¸")
        
        # ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‡ĞµÑ€ĞµĞ· API
        response = self.client.post(f'/api/requests/{request.id}/analyze/')
        assert response.status_code == 200
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°
        result = response.json()['result']
        assert result['project_title'] is not None
        
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
        project_data = {
            'title': result['project_title'],
            'project_type': result['project_type'],
            'request_id': request.id
        }
        
        project_response = self.client.post('/api/projects/', project_data)
        assert project_response.status_code == 201
```

## ğŸ“ˆ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

```python
class MonitoringService:
    def track_analysis_time(self, request_id, duration):
        """ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°"""
        logger.info(f"Analysis completed for request {request_id} in {duration}s")
    
    def track_validation_errors(self, error_type, count):
        """ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸"""
        logger.warning(f"Validation error {error_type}: {count} occurrences")
    
    def track_llm_usage(self, tokens_used, cost):
        """ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ LLM"""
        logger.info(f"LLM usage: {tokens_used} tokens, cost: ${cost}")
```

### Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

```typescript
interface MonitoringDashboardProps {
  metrics: {
    totalAnalyses: number;
    successRate: number;
    averageTime: number;
    errorRate: number;
  };
}

const MonitoringDashboard: React.FC<MonitoringDashboardProps> = ({ metrics }) => {
  return (
    <div className="monitoring-dashboard">
      <div className="metric-card">
        <h3>Ğ’ÑĞµĞ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²</h3>
        <span className="metric-value">{metrics.totalAnalyses}</span>
      </div>
      
      <div className="metric-card">
        <h3>Ğ£ÑĞ¿ĞµÑˆĞ½Ğ¾ÑÑ‚ÑŒ</h3>
        <span className="metric-value">{metrics.successRate}%</span>
      </div>
      
      <div className="metric-card">
        <h3>Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼Ñ</h3>
        <span className="metric-value">{metrics.averageTime}s</span>
      </div>
      
      <div className="metric-card">
        <h3>ĞÑˆĞ¸Ğ±ĞºĞ¸</h3>
        <span className="metric-value">{metrics.errorRate}%</span>
      </div>
    </div>
  );
};
```

## ğŸš¨ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

### Ğ¢Ğ¸Ğ¿Ñ‹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

1. **ĞÑˆĞ¸Ğ±ĞºĞ¸ LLM API**
   - Rate limit exceeded
   - Invalid API key
   - Network timeout
   - Model unavailable

2. **ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸**
   - ĞĞµĞ²ĞµÑ€Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° JSON
   - ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ
   - ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

3. **ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸**
   - Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ ÑƒĞ¶Ğµ Ğ¿Ñ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½
   - ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
   - ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

### Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

```python
class ErrorHandler:
    def handle_llm_error(self, error):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº LLM"""
        if isinstance(error, RateLimitError):
            # ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ
            return self._retry_with_delay()
        elif isinstance(error, APIKeyError):
            # ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ÑĞ¼ÑƒĞ»ÑÑ‚Ğ¾Ñ€
            return self._fallback_to_emulator()
        else:
            # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°
            self._log_error(error)
            raise error
    
    def handle_validation_error(self, error):
        """ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸"""
        if error.field == 'project_title':
            # ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
            return self._auto_fix_title()
        else:
            # Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
            return self._request_manual_fix()
```

## ğŸ”’ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° API ĞºĞ»ÑÑ‡ĞµĞ¹

```python
# settings.py
OPENAI_API_KEY = os.getenv('OPENAI_API_KEY')
if not OPENAI_API_KEY:
    raise ImproperlyConfigured("OPENAI_API_KEY not set")

# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ÑĞµÑ€Ğ²Ğ¸ÑĞµ
class LLMService:
    def __init__(self):
        self.api_key = settings.OPENAI_API_KEY
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ»ÑÑ‡Ğ°
        self._validate_api_key()
```

### Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```python
class InputValidator:
    def validate_request_text(self, text):
        """Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°"""
        if not text or len(text.strip()) < 10:
            raise ValidationError("Ğ¢ĞµĞºÑÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹")
        
        if len(text) > 10000:
            raise ValidationError("Ğ¢ĞµĞºÑÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğ¹")
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚
        if self._contains_malicious_content(text):
            raise ValidationError("Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ½ĞµĞ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚")
```

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹

- [OpenAI API Documentation](https://platform.openai.com/docs)
- [Django REST Framework](https://www.django-rest-framework.org/)
- [React TypeScript Guide](https://react-typescript-cheatsheet.netlify.app/)
- [JSON Schema Validation](https://json-schema.org/)
- [Docker Best Practices](https://docs.docker.com/develop/best-practices/)
