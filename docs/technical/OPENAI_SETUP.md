# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenAI GPT-4o –¥–ª—è Agent Assistant

## üìã **–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**

‚úÖ –°–æ–∑–¥–∞–Ω `OpenAIService` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GPT-4o API  
‚úÖ –°–æ–∑–¥–∞–Ω –ø—Ä–æ–º–ø—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–æ–≤  
‚úÖ –°–æ–∑–¥–∞–Ω–∞ JSON Schema –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤  
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É OpenAI –∏ —ç–º—É–ª—è—Ç–æ—Ä–æ–º  
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Django settings  

---

## ‚öôÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ (—à–∞–≥ –∑–∞ —à–∞–≥–æ–º):**

### **–®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á OpenAI**

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://platform.openai.com/
2. –í–æ–π–¥–∏—Ç–µ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "API keys"
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–ª—é—á
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–æ–Ω –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)

### **–®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ —Ñ–∞–π–ª `.env`**

–ù–∞–π–¥–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
/Users/andrei_prygunov/Dev/agent_assistant/.env
```

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

```bash
# OpenAI API Settings
OPENAI_API_KEY=sk-–≤–∞—à-–∫–ª—é—á-–∑–¥–µ—Å—å
OPENAI_MODEL=gpt-4o
OPENAI_TEMPERATURE=0.3
OPENAI_MAX_TOKENS=4000
OPENAI_MAX_RETRIES=3
OPENAI_TIMEOUT=60
```

**–í–ê–ñ–ù–û:** –ó–∞–º–µ–Ω–∏—Ç–µ `sk-–≤–∞—à-–∫–ª—é—á-–∑–¥–µ—Å—å` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –∫–ª—é—á!

### **–®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `backend/llm_config.yaml`:

```yaml
llm:
  use_emulator: false  # false = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenAI, true = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º—É–ª—è—Ç–æ—Ä
  model: 'gpt-4o'
  temperature: 0.3
  max_tokens: 4000
  max_retries: 3
  timeout: 60

validation:
  required_fields:
    - 'project_analysis.project_title'
    - 'project_analysis.project_type'
    - 'project_analysis.roles'
  json_schema_strict: true
  retry_on_invalid_json: true
  max_retry_attempts: 3
```

**–í–ê–ñ–ù–û:** `use_emulator: false` –≤–∫–ª—é—á–∞–µ—Ç OpenAI!

### **–®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥**

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±—ç–∫–µ–Ω–¥ (Ctrl+C)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
cd backend
python3 manage.py runserver
```

---

## üß™ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:**

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Django shell**

```bash
cd backend
python3 manage.py shell
```

```python
from llm.services import LLMService

# –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–≤–∏—Å
llm = LLMService()

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
status = llm.test_connection()
print(status)
# –û–∂–∏–¥–∞–µ–º: {'emulator_available': True, 'openai_available': True, 'current_mode': 'openai'}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Ä–≤–∏—Å–µ
info = llm.get_service_info()
print(info)
# –û–∂–∏–¥–∞–µ–º: {'service': 'openai', 'model_info': {...}}

# –¢–µ—Å—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
result = llm.analyze_request({
    'id': 1,
    'text': '–ò—â–µ–º –∞–∫—Ç–µ—Ä–∞ –¥–ª—è –∫–æ–º–µ–¥–∏–π–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞, –º—É–∂—á–∏–Ω–∞ 25-30 –ª–µ—Ç'
}, [])

print(f"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω: {result.get('model', 'emulator')}")
print(f"–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: {result['project_analysis']['project_title']}")
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ó–∞–ø—Ä–æ—Å—ã"
3. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π –∑–∞–ø—Ä–æ—Å
4. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä "–ê–Ω–∞–ª–∏–∑ LLM..."
5. –§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–¥–∞–Ω–Ω—ã–µ –æ—Ç GPT-4o!)

---

## üîÑ **–ö–∞–∫ –ø–æ–Ω—è—Ç—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OpenAI –∞ –Ω–µ —ç–º—É–ª—è—Ç–æ—Ä?**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö –±—ç–∫–µ–Ω–¥–∞:**

–í –∫–æ–Ω—Å–æ–ª–∏ –±—ç–∫–µ–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç—Ä–æ–∫–∞:
```
OpenAI Service initialized successfully
Using OpenAI GPT-4o for request analysis
```

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç–º—É–ª—è—Ç–æ—Ä, –±—É–¥–µ—Ç:
```
Using LLM Emulator for request analysis
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–∫–æ–Ω—Å–æ–ª—å):**

–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console ‚Üí –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```javascript
llm.ts: LLM Response: {
  ...
  "used_emulator": false,  // ‚Üê false = OpenAI!
  "model": "gpt-4o",       // ‚Üê –º–æ–¥–µ–ª—å OpenAI
  ...
}
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**

**–≠–º—É–ª—è—Ç–æ—Ä** –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- –ù–∞–∑–≤–∞–Ω–∏–µ: "–î—Ä—É–∑—å—è –Ω–∞–≤—Å–µ–≥–¥–∞"
- –†–æ–ª–∏: "–ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π", "–ü–æ–¥—Ä—É–≥–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è"

**GPT-4o** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞:
- –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ —Ç–µ–∫—Å—Ç–∞
- –†–æ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø–∏—Å–∞–Ω–∏—è
- –í—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ—á–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É

---

## üí∞ **–°—Ç–æ–∏–º–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OpenAI:**

### **GPT-4o —Ü–µ–Ω—ã (–Ω–∞ –º–∞–π 2024):**
- **Input:** $5 –∑–∞ 1M —Ç–æ–∫–µ–Ω–æ–≤
- **Output:** $15 –∑–∞ 1M —Ç–æ–∫–µ–Ω–æ–≤

### **–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:**
- –ü—Ä–æ–º–ø—Ç: ~1500 —Ç–æ–∫–µ–Ω–æ–≤
- –¢–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞: ~200 —Ç–æ–∫–µ–Ω–æ–≤
- –û—Ç–≤–µ—Ç: ~800 —Ç–æ–∫–µ–Ω–æ–≤
- **–ò—Ç–æ–≥–æ:** ~2500 —Ç–æ–∫–µ–Ω–æ–≤ ‚âà **$0.02** (2 —Ü–µ–Ω—Ç–∞) –∑–∞ –∑–∞–ø—Ä–æ—Å

### **100 –∑–∞–ø—Ä–æ—Å–æ–≤ = ~$2**

---

## ‚ö†Ô∏è **Troubleshooting:**

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: "OPENAI_API_KEY –Ω–µ —É–∫–∞–∑–∞–Ω"**

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–ª—é—á –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`, –¥–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É `OPENAI_API_KEY=sk-...`

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: "OpenAI API connection test failed"**

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –∏–ª–∏ –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞  
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –Ω–∞ https://platform.openai.com/
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª—é—á –Ω–µ –∏—Å—Ç–µ–∫

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: "Rate limit exceeded"**

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤  
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 –º–∏–Ω—É—Ç—É
- –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç—ã –≤ OpenAI –∞–∫–∫–∞—É–Ω—Ç–µ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–º—É–ª—è—Ç–æ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ

### **–ü—Ä–æ–±–ª–µ–º–∞ 4: –í—Å–µ —Ä–∞–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç–º—É–ª—è—Ç–æ—Ä**

**–ü—Ä–∏—á–∏–Ω–∞:** `use_emulator: true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ  
**–†–µ—à–µ–Ω–∏–µ:** 
- –û—Ç–∫—Ä–æ–π—Ç–µ `backend/llm_config.yaml`
- –ò–∑–º–µ–Ω–∏—Ç–µ `use_emulator: false`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥

### **–ü—Ä–æ–±–ª–µ–º–∞ 5: "Invalid JSON response"**

**–ü—Ä–∏—á–∏–Ω–∞:** GPT-4o –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON (—Ä–µ–¥–∫–æ)  
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è retry, –º–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏

---

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è OpenAI:**

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://platform.openai.com/usage
2. –°–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –¥–Ω—è–º
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–∏–º–∏—Ç—ã —Ä–∞—Å—Ö–æ–¥–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è $10-20/–º–µ—Å—è—Ü –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

---

## üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

‚ö†Ô∏è **–ù–ò–ö–û–ì–î–ê –ù–ï –ö–û–ú–ú–ò–¢–¨–¢–ï `.env` –§–ê–ô–õ –í GIT!**

–§–∞–π–ª `.env` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`

–ï—Å–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –∑–∞–∫–æ–º–º–∏—Ç–∏–ª–∏ –∫–ª—é—á:
1. –£–¥–∞–ª–∏—Ç–µ –∫–ª—é—á –Ω–∞ https://platform.openai.com/
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á
3. –û–±–Ω–æ–≤–∏—Ç–µ `.env`

---

## üìû **–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–º–æ—â–∏:**

- OpenAI Docs: https://platform.openai.com/docs
- OpenAI Support: https://help.openai.com/
- GitHub Issues: (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ open source)

---

## ‚úÖ **Checklist –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**

- [ ] API –∫–ª—é—á –ø–æ–ª—É—á–µ–Ω
- [ ] –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
- [ ] `llm_config.yaml` —Å–æ–∑–¥–∞–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `use_emulator: false` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –ë—ç–∫–µ–Ω–¥ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] –¢–µ—Å—Ç —á–µ—Ä–µ–∑ shell —É—Å–ø–µ—à–µ–Ω
- [ ] –¢–µ—Å—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É—Å–ø–µ—à–µ–Ω
- [ ] –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ "Using OpenAI GPT-4o"
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

**–ì–æ—Ç–æ–≤–æ! üéâ**

